:root{
  --bg:#071522;
  --panel:#0b1b2b;
  --line:#123252;
  --text:#cfe8ff;
  --good:#53e07a;
  --bad:#ff6b6b;
  --pri:#2b86ff;
  --ground-h: 96px; /* 地面の高さ（JSも読む） */
}

*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji}
b{font-weight:700}
.app{max-width:980px;margin:0 auto;padding:16px}

header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
header .title{font-size:20px}
header .balance{opacity:.9}
.toolbar{display:flex;gap:8px;align-items:center}

.panel{background:var(--panel);border:1px solid var(--line);border-radius:16px;padding:12px;margin-bottom:12px;box-shadow:0 8px 24px rgba(0,0,0,.2)}

.hud{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:8px}
.hud .mult{font-size:28px}
.x{font-weight:800}

/* ===== ステージ & 背景 ===== */
.stage{position:relative;height:320px;overflow:hidden;border-radius:12px;background:linear-gradient(#08192a,#050d16)}
.space-bg{position:absolute;inset:0;z-index:0;overflow:hidden}
.space-bg .layer{position:absolute;left:0;right:0;height:300%;background-repeat:repeat-y;background-size:cover;opacity:.7}
.space-bg .layer-deep{
  top:-100%; 
  background-image:
    radial-gradient(1200px 600px at 50% 80%, rgba(60,100,180,.35), transparent 70%),
    radial-gradient(800px 400px at 20% 20%, rgba(120,80,200,.25), transparent 70%),
    radial-gradient(900px 500px at 80% 40%, rgba(40,120,200,.25), transparent 70%);
  filter: blur(2px);
}
.space-bg .layer-mid{
  top:-100%;
  background-image:
    radial-gradient(2px 2px at 10% 10%, #bfe0ff 60%, transparent 61%),
    radial-gradient(1.5px 1.5px at 30% 60%, #cfe8ff 60%, transparent 61%),
    radial-gradient(1.5px 1.5px at 70% 30%, #b8dcff 60%, transparent 61%),
    radial-gradient(2px 2px at 90% 80%, #e0f2ff 60%, transparent 61%);
  opacity:.9;
}
.space-bg .layer-near{
  top:-100%;
  background-image:
    radial-gradient(2px 2px at 15% 30%, #fff 60%, transparent 61%),
    radial-gradient(2px 2px at 45% 50%, #fff 60%, transparent 61%),
    radial-gradient(2px 2px at 75% 20%, #fff 60%, transparent 61%),
    radial-gradient(2px 2px at 55% 85%, #fff 60%, transparent 61%);
  opacity:1;
}

/* 惑星の地面 */
.ground{
  position:absolute;left:0;right:0;bottom:0;height:var(--ground-h);z-index:2;
  background:
    radial-gradient(400px 120px at 20% 10%, rgba(0,0,0,.25), transparent 60%),
    radial-gradient(260px 100px at 70% 20%, rgba(0,0,0,.2), transparent 60%),
    linear-gradient(#2b3140,#222736);
  border-top:1px solid rgba(255,255,255,.06);
  transform: translateY(0); transition: transform .6s ease-in;
}
.ground.off{ transform: translateY(110%); } /* 発射で地面が下へ */
.ground .ridge{
  position:absolute;left:0;right:0;top:-22px;height:32px;
  background:
    radial-gradient(120% 100% at 50% 100%, #343d50 60%, transparent 61%);
  filter: blur(0.2px); opacity:.9;
}
.ground .pad{
  position:absolute;left:50%;transform:translateX(-50%);bottom:20px;width:140px;height:10px;border-radius:6px;
  background:linear-gradient(#5a6478,#3a4254); box-shadow:0 6px 10px rgba(0,0,0,.4) inset;
}
.ground .crater{
  position:absolute;bottom:26px;width:46px;height:16px;border-radius:50%;
  background:radial-gradient(ellipse at 50% 60%, #1f2432 0%, #161b28 70%, rgba(0,0,0,.0) 72%);
  opacity:.7; filter:blur(0.2px);
}
.ground .c1{ left:16%; transform:scale(1.1); }
.ground .c2{ left:42%; transform:scale(0.9); }
.ground .c3{ left:72%; transform:scale(1.0); }

.stars{position:absolute;inset:0;z-index:1}
@keyframes tw{0%{opacity:0}10%{opacity:1}90%{opacity:1}100%{opacity:0}}
.star{ 
  position:absolute;
  background:#b8e7ff;
  border-radius:50%;
  animation: tw 2.4s linear infinite, starDrift var(--fall, 40s) linear infinite;
  opacity:.6;
}
.star.s1 { width:1px; height:1px; --fall: 55s; opacity:.55; }
.star.s2 { width:2px; height:2px; --fall: 40s; opacity:.8; }
.star.s3 { width:3px; height:3px; --fall: 28s; opacity:.95; filter: drop-shadow(0 0 2px rgba(255,255,255,.4)); }
@keyframes starDrift { from { transform: translateY(-120vh); } to { transform: translateY(120vh); } }

/* ===== 宇宙船 ===== */
.rocket{position:absolute;left:50%;transform:translateX(-50%);top:210px;width:80px;z-index:3;filter:drop-shadow(0 2px 6px rgba(0,0,0,.5))}
.rocket svg{display:block;width:100%;height:auto}
.flame{
  position:absolute;left:33px;bottom:-6px;width:18px;height:18px;border-radius:50%;
  background:radial-gradient(circle,#ffd580,#ff7043 60%,rgba(0,0,0,0));
  filter:blur(1px);animation:fl .22s ease-in-out infinite
}
.rocket.idle .flame{ display:none; } /* ロビーでは炎を消す */
@keyframes fl{0%{transform:scale(1)}50%{transform:scale(1.25)}100%{transform:scale(1)}}

/* ===== ボタンや入力 ===== */
.buttons{display:flex;gap:8px;margin-top:8px}
button{border:none;border-radius:12px;padding:10px 14px;background:#0e2742;color:var(--text);cursor:pointer}
button.primary{background:linear-gradient(180deg,#2b86ff,#1f6de1)}
button.good{background:linear-gradient(180deg,#3bcf86,#2ea165)}
button.small{padding:6px 10px;border-radius:10px;font-size:12px}
button:disabled{opacity:.5;cursor:not-allowed}

.bet{display:flex;gap:8px;align-items:center;margin-top:8px;flex-wrap:wrap}
.bet input{padding:8px;border-radius:10px;border:1px solid var(--line);background:#0c2338;color:var(--text);width:140px}
.tag{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--line);font-size:12px}
.tag.ok{border-color:#2ea165}
.tag.no{border-color:#8c1f3a}

.log{margin-top:8px;max-height:140px;overflow:auto;border:1px solid var(--line);border-radius:12px;padding:8px;background:#061423;z-index:4;position:relative}

.list .row{display:grid;grid-template-columns:40px 1fr 120px 120px 120px;gap:8px;padding:6px 8px;border-bottom:1px dashed rgba(255,255,255,.05)}
.list .row.head{opacity:.8;font-size:12px}
.list .row .pwin{color:var(--good);font-weight:700}
.plose{color:var(--bad);font-weight:700}

/* チャット */
.chat-log{height:160px;overflow:auto;background:#061423;border:1px solid #0f2741;border-radius:12px;padding:8px;font-size:13px;line-height:1.4}
.chat-line .t{opacity:.6;margin-right:6px}
.chat-input{display:flex;gap:8px;margin-top:8px}
.chat-input input{flex:1;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0c2338;color:var(--text)}

/* モーダル */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.5);z-index:50}
.modal .box{min-width:280px;max-width:420px;background:#0c2135;border:1px solid var(--line);border-radius:14px;padding:14px}
.historyHead{display:flex;align-items:center;justify-content:space-between}
.grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.histCell{background:#0b1b2b;border:1px solid var(--line);border-radius:10px;padding:8px;text-align:center}

.bar{height:8px;background:#0b1b2b;border-radius:999px;overflow:hidden;border:1px solid var(--line)}
.bar i{display:block;height:100%;width:0;background:linear-gradient(90deg,#2b86ff,#34d1ff)}

.ejector{position:absolute;pointer-events:none;font-size:18px;z-index:5}
.ejector .tag{margin-left:6px;font-size:10px;background:#193655;color:#cde9ff;padding:2px 6px;border-radius:999px;vertical-align:middle}
.boom{position:absolute;width:8px;height:8px;border-radius:50%;background: radial-gradient(circle, #ffd580 0%, #ff7043 60%, rgba(0,0,0,0) 100%);pointer-events:none;z-index:5}

/* === Mobile tweaks === */
@media (max-width: 640px) {
  :root{ --ground-h: 88px; }
  .app { padding: 12px; }
  .stage { height: 300px; }
  .hud { flex-wrap: wrap; gap: 8px; }
  .hud .mult { font-size: 24px; }
  .buttons, .bet { flex-wrap: wrap; }
  .bet input { width: 100%; font-size:16px; }
  .list .row { grid-template-columns: 28px 1fr 90px 80px 80px; font-size: 13px; }
  .chat-log { height: 120px; }
}
@media (max-width: 380px) {
  .stage { height: 280px; }
  .list .row { grid-template-columns: 24px 1fr 84px 70px 70px; }
  header .title { font-size: 18px; }
  .hud .mult { font-size: 22px; }
}
html, body { overflow-x: hidden; }
